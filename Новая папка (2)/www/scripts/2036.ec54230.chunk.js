(self.webpackChunkasf_ui=self.webpackChunkasf_ui||[]).push([[2036],{7965:(t,e,o)=>{"use strict";var s=o(6426),n={"text/plain":"Text","text/html":"Url",default:"Text"};t.exports=function(t,e){var o,a,i,r,c,l,m=!1;e||(e={}),o=e.debug||!1;try{if(i=s(),r=document.createRange(),c=document.getSelection(),(l=document.createElement("span")).textContent=t,l.ariaHidden="true",l.style.all="unset",l.style.position="fixed",l.style.top=0,l.style.clip="rect(0, 0, 0, 0)",l.style.whiteSpace="pre",l.style.webkitUserSelect="text",l.style.MozUserSelect="text",l.style.msUserSelect="text",l.style.userSelect="text",l.addEventListener("copy",(function(s){if(s.stopPropagation(),e.format)if(s.preventDefault(),void 0===s.clipboardData){o&&console.warn("unable to use e.clipboardData"),o&&console.warn("trying IE specific stuff"),window.clipboardData.clearData();var a=n[e.format]||n.default;window.clipboardData.setData(a,t)}else s.clipboardData.clearData(),s.clipboardData.setData(e.format,t);e.onCopy&&(s.preventDefault(),e.onCopy(s.clipboardData))})),document.body.appendChild(l),r.selectNodeContents(l),c.addRange(r),!document.execCommand("copy"))throw new Error("copy command was unsuccessful");m=!0}catch(s){o&&console.error("unable to copy using execCommand: ",s),o&&console.warn("trying IE specific stuff");try{window.clipboardData.setData(e.format||"text",t),e.onCopy&&e.onCopy(window.clipboardData),m=!0}catch(s){o&&console.error("unable to copy using clipboardData: ",s),o&&console.error("falling back to prompt"),a=function(t){var e=(/mac os x/i.test(navigator.userAgent)?"âŒ˜":"Ctrl")+"+C";return t.replace(/#{\s*key\s*}/g,e)}("message"in e?e.message:"Copy to clipboard: #{key}, Enter"),window.prompt(a,t)}}finally{c&&("function"==typeof c.removeRange?c.removeRange(r):c.removeAllRanges()),l&&document.body.removeChild(l),i()}return m}},1201:(t,e,o)=>{var s=o(1601),n=o(6314)(s);n.push([t.id,".form-item__token{display:grid;grid-column-gap:.75em;grid-template-columns:1fr auto;justify-content:center;padding-bottom:1em}.form-item__token :focus{outline:none}.form-item__delete{padding-top:1em;text-align:center}.form-item__delete a{color:var(--color-text-dark);cursor:pointer}.form-item__delete a:hover{color:red}.form-item__input-token{font-size:2.4em;font-weight:bold;height:2.3em;letter-spacing:.3em;text-align:center;text-indent:.3em;width:6em}.app--dark-mode .form-item__input-token{border-color:var(--color-text-dark)}.button--helper{max-width:2em}a{color:var(--color-theme)}",""]),t.exports=n},6426:t=>{t.exports=function(){var t=document.getSelection();if(!t.rangeCount)return function(){};for(var e=document.activeElement,o=[],s=0;s<t.rangeCount;s++)o.push(t.getRangeAt(s));switch(e.tagName.toUpperCase()){case"INPUT":case"TEXTAREA":e.blur();break;default:e=null}return t.removeAllRanges(),function(){"Caret"===t.type&&t.removeAllRanges(),t.rangeCount||o.forEach((function(e){t.addRange(e)})),e&&e.focus()}}},2036:(t,e,o)=>{"use strict";o.r(e),o.d(e,{default:()=>r});var s=function(){var t=this,e=t._self._c;return t.bot?e("main",{staticClass:"main-container"},[e("h2",{directives:[{name:"tooltip",rawName:"v-tooltip",value:t.bot.name,expression:"bot.name"}],staticClass:"title"},[t._v(t._s(t.bot.viewableName))]),t._v(" "),t.has2FA?e("div",{staticClass:"form-item"},[e("div",{staticClass:"form-item__token"},[e("input",{staticClass:"form-item__input form-item__input-token",attrs:{type:"text",readonly:""},domProps:{value:t.token}}),t._v(" "),e("div",{staticClass:"form-item__buttons form-item__buttons--column"},[e("button",{directives:[{name:"tooltip",rawName:"v-tooltip.left",value:t.$t("2fa-token-refresh"),expression:"$t('2fa-token-refresh')",modifiers:{left:!0}}],staticClass:"button button--helper",on:{click:t.refreshToken}},[t.refreshing?e("FontAwesomeIcon",{attrs:{icon:"spinner",size:"lg",spin:""}}):e("FontAwesomeIcon",{attrs:{icon:"redo-alt",size:"lg"}})],1),t._v(" "),e("button",{directives:[{name:"tooltip",rawName:"v-tooltip.left",value:t.$t("2fa-token-copy"),expression:"$t('2fa-token-copy')",modifiers:{left:!0}}],staticClass:"button button--helper",on:{click:t.copyToken}},[e("FontAwesomeIcon",{attrs:{icon:"clipboard",size:"lg"}})],1)])]),t._v(" "),e("div",{staticClass:"form-item__buttons form-item__buttons--center form-item__buttons--column"},[e("button",{staticClass:"button button--confirm",on:{click:t.acceptConfirmations}},[t.accepting?e("FontAwesomeIcon",{attrs:{icon:"spinner",spin:""}}):e("span",[t._v(t._s(t.$t("2fa-accept")))])],1),t._v(" "),e("button",{staticClass:"button button--cancel",on:{click:t.rejectConfirmations}},[t.rejecting?e("FontAwesomeIcon",{attrs:{icon:"spinner",spin:""}}):e("span",[t._v(t._s(t.$t("2fa-reject")))])],1)]),t._v(" "),e("div",{staticClass:"form-item__delete"},[e("a",{on:{click:function(e){return t.$router.push({name:"bot-2fa-delete"})}}},[t._v(t._s(t.$t("2fa-delete",{name:t.bot.viewableName})))])])]):e("div",[e("p",{staticClass:"info",domProps:{innerHTML:t._s(t.$t("2fa-not-found"))}}),t._v(" "),e("div",{staticClass:"form-item__buttons form-item__buttons--center"},[e("input",{ref:"file",staticClass:"hidden",attrs:{type:"file",accept:".maFile"},on:{change:t.onImport}}),t._v(" "),e("button",{staticClass:"button button--confirm",on:{click:function(e){return t.$refs.file.click()}}},[t.importing?e("FontAwesomeIcon",{attrs:{icon:"spinner",spin:""}}):e("span",[t._v(t._s(t.$t("2fa-import")))])],1)])])]):t._e()};s._withStripped=!0;var n=o(7965),a=o(9432);const i={name:"Bot2fa",data:()=>({importing:!1,accepting:!1,rejecting:!1,refreshing:!1,token:"-----",has2FA:!0}),computed:{bot(){return this.$store.getters["bots/bot"](this.$route.params.bot)}},watch:{async token(){"-----"!==this.token&&(await(0,a.A)(3e4),this.token="-----")},$route:{immediate:!0,async handler(){this.bot&&this.bot.has2FA?(this.has2FA=!0,this.refreshToken()):this.has2FA=!1}}},async created(){this.bot||this.$router.replace({name:"bots"})},methods:{async onImport(){if(!this.importing){this.importing=!0;try{const t=this.bot.name,e=this.$refs.file.files[0],o=await this.readFile(e),s=await this.$http.post(`bot/${t}/twoFactorAuthentication`,JSON.parse(o));s[t].Success?(this.$success(this.$t("2fa-import-success",{bot:t})),await(0,a.A)(1e3),this.$router.push({name:"bots"})):this.$error(s[t].Message)}catch(t){this.$error(t.message)}finally{this.importing=!1}}},readFile:t=>new Promise(((e,o)=>{const s=new FileReader;s.onload=t=>{e(t.target.result)},s.onerror=o,s.readAsText(t)})),async acceptConfirmations(){if(!this.accepting){this.accepting=!0;try{const t=this.bot.name,e=await this.$http.post(`bot/${t}/twoFactorAuthentication/confirmations`,{accept:!0});if(e[t].Success){const o=e[t].Message.match(/\d+/)[0];"0"===o?this.$info(this.$t("2fa-accept-not-found")):this.$success(this.$t("2fa-accept-success",{bot:t,n:o}))}else this.$error(e[t].Message)}catch(t){this.$error(t.message)}finally{this.accepting=!1}}},async rejectConfirmations(){if(!this.rejecting){this.rejecting=!0;try{const t=this.bot.name,e=await this.$http.post(`bot/${t}/twoFactorAuthentication/confirmations`,{accept:!1});if(e[t].Success){const o=e[t].Message.match(/\d+/)[0];"0"===o?this.$info(this.$t("2fa-reject-not-found")):this.$success(this.$t("2fa-reject-success",{bot:t,n:o}))}else this.$error(e[t].Message)}catch(t){this.$error(t.message)}finally{this.rejecting=!1}}},async refreshToken(){if(!this.refreshing){this.refreshing=!0,this.token="-----";try{const t=this.bot.name,e=await this.$http.get(`bot/${t}/twoFactorAuthentication/token`);e[t].Result&&e[t].Success?this.token=e[t].Result:this.$error(e[t].Message)}catch(t){this.$error(t.message)}finally{this.refreshing=!1}}},copyToken(){n(this.token),this.$info(this.$t("2fa-token-copied"))}}};o(315);const r=(0,o(4486).A)(i,s,[],!1,null,null,null).exports},315:(t,e,o)=>{var s=o(1201);s.__esModule&&(s=s.default),"string"==typeof s&&(s=[[t.id,s,""]]),s.locals&&(t.exports=s.locals),(0,o(534).A)("8856284c",s,!1,{})}}]);