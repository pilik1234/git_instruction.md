(self.webpackChunkasf_ui=self.webpackChunkasf_ui||[]).push([[5104],{234:(t,e,s)=>{"use strict";function a(t){const e=document.implementation.createHTMLDocument().createElement("html");return e.innerHTML=t,e}s.d(e,{A:()=>a})},3367:(t,e,s)=>{"use strict";s.d(e,{A:()=>i});var a=s(5896),n=s(9118);async function i(t,e,s){const i=await async function(t,e,s){const i=(0,n.A)(s),r=`www/github/wiki/page/${t}${i}`;if(!e)return r;if(e>=(await a.Jt("www/github/release")).Version)return r;const m=await a.Jt(`www/github/release/${e}`),o=new Date(m.ReleasedAt),c=await a.Jt(`www/github/wiki/history/${t}${i}`),d=Object.entries(c).map((t=>({id:t[0],releaseTime:new Date(t[1])})));d.sort(((t,e)=>new Date(e.releaseTime)-new Date(t.releaseTime)));const l=d.find((({releaseTime:t})=>t<o));return l?`${r}?revision=${l.id}`:r}(t,e,s);return a.Jt(i)}},9118:(t,e,s)=>{"use strict";function a(t){return"en-US"!==t?`-${t}`:""}s.d(e,{A:()=>a})},8594:(t,e,s)=>{var a=s(1601),n=s(6314)(a);n.push([t.id,".commands{display:grid;grid-template-rows:1fr}.commands>div{min-height:0}.sign-input{cursor:pointer}.timestamp{margin-right:.5em}",""]),t.exports=n},5104:(t,e,s)=>{"use strict";s.r(e),s.d(e,{default:()=>d});var a=function(){var t=this,e=t._self._c;return e("main",{staticClass:"main-container main-container--fullheight commands"},[e("div",{staticClass:"container"},[e("div",{ref:"terminal",staticClass:"terminal",on:{click:t.focusInput}},[t._l(t.log,(function({type:s,time:a,message:n},i){return e("div",{key:i,staticClass:"terminal-message"},[t.timestamps?e("span",{staticClass:"terminal-message__time timestamp"},[t._v("["+t._s(a)+"]")]):t._e(),t._v(" "),e("span",{staticClass:"terminal-message__sign",class:`terminal-message__sign--${s}`,domProps:{textContent:t._s("out"===s?">":"<")}}),t._v(" "),e("span",{staticClass:"terminal-message__content"},[t._v(t._s(n))])])})),t._v(" "),e("div",{staticClass:"terminal__input-wrapper"},[e("span",{directives:[{name:"tooltip",rawName:"v-tooltip",value:t.$t("commands-send"),expression:"$t('commands-send')"}],staticClass:"terminal-message__sign sign-input",on:{click:t.sendCommand}},[t._v(">")]),t._v(" "),e("input",{ref:"terminal-input",staticClass:"terminal__input",attrs:{type:"text",spellcheck:"false"},domProps:{value:t.command},on:{input:function(e){t.command=e.target.value},keydown:[function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.sendCommand.apply(null,arguments)},function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"tab",9,e.key,"Tab")?null:(e.preventDefault(),t.autocomplete.apply(null,arguments))},function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"up",38,e.key,["Up","ArrowUp"])?null:t.historyPrevious.apply(null,arguments)},function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"down",40,e.key,["Down","ArrowDown"])?null:t.historyNext.apply(null,arguments)},function(e){return(e.type.indexOf("key")||65===e.keyCode)&&e.ctrlKey?(e.preventDefault(),t.jumpToStart.apply(null,arguments)):null},function(e){return(e.type.indexOf("key")||75===e.keyCode)&&e.ctrlKey?(e.preventDefault(),t.removeAfterCursor.apply(null,arguments)):null},function(e){return(e.type.indexOf("key")||76===e.keyCode)&&e.ctrlKey?(e.preventDefault(),t.clearTerminal.apply(null,arguments)):null}]}}),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model",value:t.autocompleteSuggestion,expression:"autocompleteSuggestion"}],staticClass:"terminal__input terminal__input--autocomplete",attrs:{type:"text",spellcheck:"false"},domProps:{value:t.autocompleteSuggestion},on:{input:function(e){e.target.composing||(t.autocompleteSuggestion=e.target.value)}}})])],2)])])};a._withStripped=!0;var n=s(5353),i=s(2822),r=s(3367),m=s(234);class o{constructor(t){this._cache=[],this._maxLength=t}get length(){return this._cache.length}get(t){return this._cache[t]||""}add(t){this.get(0)!==t&&(this._cache.unshift(t),this.save())}trim(){for(;this.length>this._maxLength;)this._cache.pop()}save(){i.hZ("command-history",this._cache)}load(){const t=i.Jt("command-history");t&&Array.isArray(t)&&(this._cache=t),this.trim()}clear(){this._cache=[],i.TF("command-history")}}const c={name:"Commands",metaInfo(){return{title:this.$t("commands")}},data:()=>({command:"",log:[],commandHistory:new o(20),commandHistoryIndex:-1,asfCommands:[],lastTabPressTime:0}),computed:{...(0,n.L8)({version:"asf/version",timestamps:"settings/timestamps"}),commands(){return[...this.asfCommands.filter((({command:t})=>"help"!==t)),{command:"oa",description:this.$t("terminal-command-oa")},{command:"r",description:this.$t("terminal-command-r")},{command:"r^",description:this.$t("terminal-command-r-mode")},{command:"sa",description:this.$t("terminal-command-sa")}]},commandsNames(){return this.commands.map((t=>t.command.split(" ")[0])).sort()},uiCommands(){return[{command:"commands",description:this.$t("terminal-commands")},{command:"help <Command>",description:this.$t("terminal-help")},{command:"clear",description:this.$t("terminal-command-clear")},{command:"clearhistory",description:this.$t("terminal-command-clear-history")}]},uiCommandsNames(){return this.uiCommands.map((t=>t.command.split(" ")[0])).sort()},allCommands(){return this.commands.concat(this.uiCommands).sort()},allCommandsNames(){return this.commandsNames.concat(this.uiCommandsNames).sort()},allCommandsParameters(){return this.allCommands.map((({command:t})=>t.split(" "))).map((([t,...e])=>({command:t,params:e}))).reduce(((t,{command:e,params:s})=>(t[e]=s,t)),{})},autocompleteSuggestion(){if(this.suggestedCommand)return this.command.replace(/./g," ")+this.suggestedCommand.substr(this.command.length);if(this.selectedCommand){if(!this.suggestedParameters||!this.suggestedParameters.length)return;if(this.suggestedParameterValue)return[this.command.replace(/./g," ")+this.suggestedParameterValue.slice(this.currentParameterValue.length),...this.suggestedParameters.slice(this.currentParameterIndex)].join(" ");const t=this.suggestedParameters.slice(this.currentParameterValue.length?this.currentParameterIndex:this.currentParameterIndex-1);return!t.length&&this.currentParameter&&t.push(this.currentParameter),this.command.replace(/./g," ")+(this.currentParameterValue.length?" ":"")+t.join(" ")}},suggestedCommand(){if(this.command)return this.allCommandsNames.find((t=>t.startsWith(this.command)))},suggestedParameters(){return this.selectedCommand&&this.allCommandsParameters[this.selectedCommand]?this.allCommandsParameters[this.selectedCommand]:[]},currentParameterIndex(){return this.command.split(" ").length-1},currentParameter(){if(!this.suggestedParameters.length)return;const t=this.suggestedParameters[this.currentParameterIndex-1];if(t)return t;const e=this.suggestedParameters[this.suggestedParameters.length-1];return"s"===e.substr(-2,1)?e:void 0},currentParameterValue(){if(this.currentParameter&&"s"===this.currentParameter.substr(-2,1)){const t=this.command.split(" ")[this.currentParameterIndex].split(",");return t[t.length-1]}return this.command.split(" ")[this.currentParameterIndex]},suggestedParameterValue(){if(this.currentParameterValue&&this.currentParameterValue.length&&this.currentParameter)switch(this.currentParameter.toLowerCase()){case"[bot]":case"[bots]":case"<targetbot>":return[...this.$store.getters["bots/bots"].map((t=>t.name)),"ASF"].find((t=>t.startsWith(this.currentParameterValue)))||[...this.$store.getters["bots/bots"].map((t=>t.name)),"ASF"].find((t=>t.toLowerCase().startsWith(this.currentParameterValue.toLowerCase())));case"<command>":return this.allCommandsNames.find((t=>t.startsWith(this.currentParameterValue)));case"<modes>":return"transfer"===this.selectedCommand?["All","Background","Booster","Card","Emoticon","Foil","Gems","Unknown"].find((t=>t.toLowerCase().startsWith(this.currentParameterValue.toLowerCase()))):"redeem^"===this.selectedCommand?["FD","FF","FKMD","SD","SF","SI","SKMG","V"].find((t=>t.toLowerCase().startsWith(this.currentParameterValue.toLowerCase()))):void 0;case"<type>":if("input"!==this.selectedCommand)return;return["DeviceID","Login","Password","SteamGuard","SteamParentalCode","TwoFactorAuthentication"].find((t=>t.toLowerCase().startsWith(this.currentParameterValue.toLowerCase())));case"<settings>":if("privacy"!==this.selectedCommand)return;return["Private","FriendsOnly","Public"].find((t=>t.toLowerCase().startsWith(this.currentParameterValue.toLowerCase())))}},selectedCommand(){if(this.command)return this.allCommandsNames.find((t=>t===this.command.split(" ")[0]))}},watch:{log(){this.$nextTick((()=>{this.$refs.terminal.scrollTop=Math.max(0,this.$refs.terminal.scrollHeight-this.$refs.terminal.clientHeight)}))}},async created(){this.commandHistory.load(),this.asfCommands=await this.loadCommands()},mounted(){this.log.push({type:"in",time:this.getTimestamp(),message:this.$t("commands-default")}),this.$refs["terminal-input"].focus()},methods:{async sendCommand(){const t=this.command.trim();if(this.command="",!t)return;this.commandHistoryIndex=-1,this.commandHistory.add(t);const e={type:"in",time:"...",message:"..."};this.log.push({type:"out",time:this.getTimestamp(),message:t}),this.log.push(e);try{const s=await this.executeCommand(t);e.message=s.trim()}catch(t){e.message=`Error: ${t.message}`}finally{e.time=this.getTimestamp()}},async executeCommand(t){switch(t.split(" ")[0]){case"commands":return this.$t("terminal-available-commands",{commands:this.commandsNames.join(", "),uiCommands:this.uiCommandsNames.join(", ")});case"help":return t.split(" ")[1]?this.commandHelp(t.split(" ")[1]):this.$t("terminal-help-text");case"clear":return this.log=[];case"clearhistory":return this.commandHistory.clear(),this.$t("terminal-command-cleared")}return this.$http.command(t)},getTimestamp:()=>(new Date).toLocaleTimeString(),commandHelp(t){const e=this.allCommands.find((e=>e.command.split(" ")[0]===t));return e?e.description:this.$t("terminal-no-help",{command:t})},focusInput(){("getSelection"in window?window.getSelection().toString():"selection"in document&&"Text"===document.selection.type&&document.selection.createRange().text)||this.$refs["terminal-input"].focus()},autocomplete(){if(this.selectedCommand||(this.command=this.suggestedCommand||this.command),this.selectedCommand&&this.suggestedParameterValue){const t=this.command.split(" "),e=t[t.length-1].split(",");this.command=[...t.slice(0,-1),[...e.slice(0,-1),this.suggestedParameterValue].join(",")].join(" ")}else if("oa"===this.command)this.command="owns ASF";else if("sa"===this.command)this.command="status ASF";else if("r"===this.command)this.command="redeem";else if("r^"===this.command)this.command="redeem^";else if(""===this.command){const t=Date.now();t-this.lastTabPressTime<=500&&(this.command="commands"),this.lastTabPressTime=t}},historyPrevious(){this.commandHistoryIndex+1<this.commandHistory.length&&(this.commandHistoryIndex++,this.command=this.commandHistory.get(this.commandHistoryIndex)),this.moveCursorToEnd()},historyNext(){this.commandHistoryIndex>0?(this.commandHistoryIndex--,this.command=this.commandHistory.get(this.commandHistoryIndex)):0===this.commandHistoryIndex&&(this.commandHistoryIndex=-1,this.command="")},clearTerminal(){this.log=[]},jumpToStart(){this.$refs["terminal-input"].setSelectionRange(0,0)},removeAfterCursor(){const t=this.$refs["terminal-input"].selectionStart;this.command=this.command.substr(0,t)},moveCursorToEnd(){const t=this.$refs["terminal-input"],e=this.command.length;t.setSelectionRange&&setTimeout((()=>t.setSelectionRange(e,e)),0)},parseCommandsHTML(t){const e=(0,m.A)(t).querySelector(".markdown-heading > h2").parentElement.nextElementSibling;return Array.from(e.querySelectorAll("tbody tr")).map((t=>t.textContent.trim().split("\n"))).map((([t,e,s])=>({command:t,access:e,description:s})))},async fetchCommands(){const{locale:t}=this.$i18n,e=await(0,r.A)("Commands",this.version,t),s=this.parseCommandsHTML(e);return i.hZ(`cache:asf-commands:${t}`,{timestamp:Date.now(),commands:s}),s},async loadCommands(){const{locale:t}=this.$i18n,e=i.Jt(`cache:asf-commands:${t}`);if(e){const{timestamp:t,commands:s}=e;if(t>Date.now()-216e5)return s}return this.fetchCommands()}}};s(3261);const d=(0,s(4486).A)(c,a,[],!1,null,null,null).exports},3261:(t,e,s)=>{var a=s(8594);a.__esModule&&(a=a.default),"string"==typeof a&&(a=[[t.id,a,""]]),a.locals&&(t.exports=a.locals),(0,s(534).A)("0c84ddf5",a,!1,{})}}]);